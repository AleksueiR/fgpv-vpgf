!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=90)}({90:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.GeoSearch=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(91),u=r(o),l=n(92),s=r(l),c=n(95),f=r(c),p=n(97),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(p),h="https://geogratis.gc.ca/services/geolocation/${language}/locate",v="https://geogratis.gc.ca/services/geoname/${language}/geonames.json",y=void 0,g=function(){function e(t){i(this,e),t=t||{};var n=t.language?t.language:"en",r=t.geoLocateUrl?t.geoLocateUrl:h,a=t.geoNameUrl?t.geoNameUrl:v;r=r.replace("${language}",n),a=a.replace("${language}",n),this.config={language:n,types:(0,f.default)(n),provinces:(0,s.default)(n),maxResults:t.maxResults?t.maxResults:100,geoNameUrl:a,geoLocateUrl:r},this.config.types.filterValidTypes(t.includeTypes,t.excludeTypes)}return a(e,[{key:"ui",value:function(e,t,n,r,i){return this.resultHandler=e?e.bind(this):this.defaultResultHandler,this.featureHandler=t?t.bind(this):this.defaultFeatureHandler,this.docFrag=document.createDocumentFragment(),n||(n=document.createElement("input"),this.docFrag.appendChild(n)),n.onkeyup=this.inputChanged.bind(this),i?this.featureContainer=i:(this.featureContainer=document.createElement("div"),this.docFrag.appendChild(this.featureContainer)),r?this.resultContainer=r:(this.resultContainer=document.createElement("div"),this.docFrag.appendChild(this.resultContainer)),this.resultContainer.classList.add("geosearch-ui"),this.featureContainer.classList.add("geosearch-ui"),this}},{key:"defaultResultHandler",value:function(e){var t=document.createElement("ul");return e.reverse().forEach(function(e){var n=document.createElement("li");n.innerHTML=e.name+" ("+e.type+")"+(e.location?", "+e.location:"")+", "+e.province+" @ lat: "+e.latLon.lat+", lon: "+e.latLon.lon,t.appendChild(n)}),t}},{key:"defaultFeatureHandler",value:function(e){var t=void 0;t=d.isFSAResult(e)?e.fsa+" - FSA located in "+e.province+" @ lat: "+e.latLon.lat+", lon: "+e.latLon.lon:e.nts+" - NTS located in "+e.location+" @ lat: "+e.latLon.lat+", lon: "+e.latLon.lon;var n=document.createElement("p");return n.innerHTML=t,n}},{key:"inputChanged",value:function(e){var t=this,n=e.target.value;if(n.length>2&&n!==y){for(y=n;this.resultContainer.firstChild;)this.resultContainer.removeChild(this.resultContainer.firstChild);for(;this.featureContainer.firstChild;)this.featureContainer.removeChild(this.featureContainer.firstChild);this.query(n).onComplete.then(function(e){e.featureResults&&t.featureContainer.appendChild(t.featureHandler(e.featureResults)),t.resultContainer.appendChild(t.resultHandler(e.results))}).catch(function(e){var n=document.createElement("p");n.innerHTML=e,t.resultContainer.appendChild(n)})}}},{key:"query",value:function(e){return(0,u.default)(this.config,e)}},{key:"htmlElem",get:function(){return this.docFrag}}]),e}();t.GeoSearch=g,window&&(window.GeoSearch=g)},91:function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e,t){if(/^[ABCEGHJKLMNPRSTVXY]\d[A-Z]/.test(t))return new s(e,t);if(/^\d{2,3}[A-P]/.test(t))return t=t.substring(0,6).toUpperCase(),new l(e,t);if(/^[A-Za-z]/.test(t)){var n=new u(e,t);return n.onComplete=n.search().then(function(e){return n.results=e,n}),n}var r=new u(e,t);return r.onComplete=new Promise(function(e){return e(r)}),r};var u=t.Query=function(){function e(t,n){a(this,e),this.suggestions=[],this.results=[],this.query=n||null,this.config=t}return o(e,[{key:"getUrl",value:function(e,t,n,r,i){var a="",o=n||this.query;return a=e?this.config.geoLocateUrl+"?q="+o:r&&i?this.config.geoNameUrl+"?lat="+r+"&lon="+i+"&num="+this.config.maxResults:this.config.geoNameUrl+"?q="+o+"&num="+this.config.maxResults,t&&(4===t.length?a+="&bbox="+t.join(","):a+="&province="+t.join(",")),a}},{key:"normalizeNameItems",value:function(e){var t=this;return e.filter(function(e){return t.config.types.validTypes[e.concise.code]}).map(function(e){return{name:e.name,location:e.location,province:t.config.provinces.list[e.province.code],type:t.config.types.allTypes[e.concise.code],latLon:{lat:e.latitude,lon:e.longitude},bbox:e.bbox}})}},{key:"search",value:function(e){var t=this;return this.jsonRequest(this.getUrl(!1,e)).then(function(e){return t.normalizeNameItems(e.items)})}},{key:"nameByLatLon",value:function(e,t,n){var r=this;return this.jsonRequest(this.getUrl(!1,n,void 0,e,t)).then(function(e){return r.normalizeNameItems(e.items)})}},{key:"locateByQuery",value:function(e){return this.jsonRequest(this.getUrl(!0,void 0,e))}},{key:"jsonRequest",value:function(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="json",r.onload=function(){200===r.status?t("string"==typeof r.response?JSON.parse(r.response):r.response):n("Could not load results from remote service.")},r.send()})}}]),e}(),l=function(e){function t(e,n){a(this,t),n=parseInt(n[2])?n:"0"+n;var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.unitName=n,i.onComplete=new Promise(function(e,t){i.locateByQuery().then(function(n){if(n.length>0&&i.query){var r=i.locateToResult(n);i.unit=r.splice(r.findIndex(function(e){return e.nts===i.query}),1)[0],i.mapSheets=r,i.featureResults=i.unit,i.nameByLatLon(i.unit.latLon.lat,i.unit.latLon.lon).then(function(t){i.results=t,e(i)})}else t("Not found")})}),i}return i(t,e),o(t,[{key:"locateToResult",value:function(e){var t=this;return e.map(function(e){var n=e.title.split(" ");return{nts:n.shift()||"",location:n.join(" "),code:"NTS",desc:t.config.types.allTypes.NTS,latLon:{lat:e.geometry.coordinates[1],lon:e.geometry.coordinates[0]},bbox:e.bbox}})}},{key:"equals",value:function(e){return this.unitName===e.unitName}}]),t}(u),s=function(e){function t(e,n){a(this,t),n=n.substring(0,3).toUpperCase();var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.onComplete=new Promise(function(e,t){i.formatLocationResult().then(function(n){null!==n?(i.featureResults=n,i.nameByLatLon(n.latLon.lat,n.latLon.lon,Object.keys(n._provinces).map(function(e){return parseInt(e)})).then(function(t){i.results=t,e(i)})):t("FSA code given cannot be found.")})}),i}return i(t,e),o(t,[{key:"formatLocationResult",value:function(){var e=this;return this.locateByQuery().then(function(t){if(1===t.length&&e.query){var n=e.config.provinces.fsaToProvinces(e.query);return{fsa:e.query,code:"FSA",desc:e.config.types.allTypes.FSA,province:Object.keys(n).map(function(e){return n[e]}).join(","),_provinces:n,latLon:{lat:t[0].geometry.coordinates[1],lon:t[0].geometry.coordinates[0]}}}return null})}}]),t}(u)},92:function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e){return c[e]=c[e]?c[e]:new f(e)};var o=n(93),u=r(o),l=n(94),s=r(l),c={},f=function(){function e(t){var n=this;i(this,e),this.list={},Object.keys(u[t]).forEach(function(e){n.list[e]=u[t][e]})}return a(e,[{key:"fsaToProvinces",value:function(e){var t=this,n={},r=s[e.substring(0,1).toUpperCase()];return"number"==typeof r&&(r=[r]),r.forEach(function(e){n[e]=t.list[e]}),n}}]),e}()},93:function(e,t){e.exports={en:{10:"Newfoundland and Labrador",11:"Prince Edward Island",12:"Nova Scotia",13:"New Brunswick",24:"Quebec",35:"Ontario",46:"Manitoba",47:"Saskatchewan",48:"Alberta",59:"British Columbia",60:"Yukon",61:"Northwest Territories",62:"Nunavut",72:"Undersea Feature",73:"International Waters"},fr:{10:"Terre-Neuve-et-Labrador",11:"Île-du-Prince-Édouard",12:"Nouvelle-Écosse",13:"Nouveau-Brunswick",24:"Québec",35:"Ontario",46:"Manitoba",47:"Saskatchewan",48:"Alberta",59:"Colombie-Britannique",60:"Yukon",61:"Territoires du Nord-Ouest",62:"Nunavut",72:"Entité sous-marine",73:"Eaux internationales"}}},94:function(e,t){e.exports={A:10,B:12,C:11,E:13,G:24,H:24,J:24,K:35,L:35,M:35,N:35,P:35,R:46,S:47,T:48,V:59,X:[62,61],Y:60}},95:function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e){return l[e]=l[e]?l[e]:new s(e)};var o=n(96),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o),l={},s=function(){function e(t){var n=this;i(this,e),this.allTypes={},this.validTypes={},this.filterComplete=!1,Object.keys(u[t]).forEach(function(e){n.allTypes[e]=u[t][e],n.validTypes[e]=u[t][e]})}return a(e,[{key:"filterValidTypes",value:function(e,t){if(this.filterComplete)return this.validTypes;e="string"==typeof e?[e]:e,t="string"==typeof t?[t]:t;var n=e||t?e&&e.length>0||t&&t.length:null;if(null!==n){var i=new Set(Object.keys(this.validTypes)),a=new Set(e||t),o=new Set([].concat(r(i)).filter(function(e){return!n===a.has(e)})),u=!0,l=!1,s=void 0;try{for(var c,f=o[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var p=c.value;delete this.validTypes[p]}}catch(e){l=!0,s=e}finally{try{!u&&f.return&&f.return()}finally{if(l)throw s}}}return this.filterComplete=!0,this.validTypes}}]),e}()},96:function(e,t){e.exports={en:{FSA:"Forward Sortation Area",NTS:"National Topographic System",PROV:"Province",TERR:"Territory",CITY:"City",TOWN:"Town",VILG:"Village",HAM:"Hamlet",UTM:"Upper Tier Municipality",LTM:"Lower Tier Municipality",STM:"Single Tier Municipality",MUN1:"Other Municipal-District Area-Major Agglom.",MUN2:"Other Municipal-District Area-Miscellaneous",UNP:"Unincorporated place",IR:"Indian Reserve",GEOG:"Geographical Area",PARK:"Conservation Area",MIL:"Military Area",RIV:"River",RIVF:"River Feature",FALL:"Falls",LAKE:"Lake",SPRG:"Spring",SEA:"Sea",SEAF:"Sea Feature",SEAU:"Undersea Feature",CHAN:"Channel",RAP:"Rapids",BAY:"Bay",CAPE:"Cape",BCH:"Beach",SHL:"Shoal",ISL:"Island",CLF:"Cliff",MTN:"Mountain",VALL:"Valley",PLN:"Plain",CAVE:"Cave",CRAT:"Crater",GLAC:"Glacier",FOR:"Forest",VEGL:"Low Vegetation",MISC:"Miscellaneous",RAIL:"Railway Feature",ROAD:"Road Feature",AIR:"Air Navigation Feature",MAR:"Marine Navigation Feature",HYDR:"Hydraulic Construction",RECR:"Recreational Site",RES:"Natural Resources Site",CAMP:"Miscellaneous Campsite",SITE:"Miscellaneous Site"},fr:{FSA:"Région De Tri D'Acheminement",NTS:"Système National De Référence Cartographique",PROV:"Province",TERR:"Territoire",CITY:"Ville",TOWN:"Ville",VILG:"Village",HAM:"Hameau",UTM:"Municipalité de palier supérieure",LTM:"Municipalité de palier inférieur",STM:"Municipalité de palier simple",MUN1:"Autre zone municip.-District-Agglom. majeure",MUN2:"Autre zone municipale-District-Divers",UNP:"Lieu non organisé",IR:"Réserve indienne",GEOG:"Zone géographique",PARK:"Zone de préservation",MIL:"Réserve militaire",RIV:"Cours d'eau",RIVF:"Entité fluviale",FALL:"Chute",LAKE:"Lac",SPRG:"Source",SEA:"Mer",SEAF:"Entité maritime",SEAU:"Entité sous-marine",CHAN:"Chenal",RAP:"Rapide",BAY:"Baie",CAPE:"Cap",BCH:"Plage",SHL:"Haut-fond",ISL:"Île",CLF:"Escarpement",MTN:"Montagne",VALL:"Vallée",PLN:"Plaine",CAVE:"Caverne",CRAT:"Cratère",GLAC:"Glacier",FOR:"Forêt",VEGL:"Végétation basse",MISC:"Divers",RAIL:"Entité ferroviaire",ROAD:"Entité routière",AIR:"Entité de navigation aérienne",MAR:"Entité de navigation maritime",HYDR:"Construction hydraulique",RECR:"Site récréationnel",RES:"Site de ressources naturelles",CAMP:"Camp-Divers",SITE:"Site-Divers"}}},97:function(e,t,n){"use strict";function r(e){return!!e.fsa}function i(e){return!!e.nts}Object.defineProperty(t,"__esModule",{value:!0}),t.isFSAResult=r,t.isNTSResult=i}});
//# sourceMappingURL=geosearch.js.map