!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=90)}({90:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.Defs=t.Types=t.Provinces=t.Q=t.GeoSearch=void 0;var o,a=n(91),u=i(a),s=n(92),l=r(s),c=n(95),f=r(c),p=n(97),d=i(p),h="https://geogratis.gc.ca/services/geolocation/@{language}/locate",y="https://geogratis.gc.ca/services/geoname/@{language}/geonames.json",v=function(){function e(e){e=e||{};var t=e.language?e.language:"en",n=e.geoLocateUrl?e.geoLocateUrl:h,r=e.geoNameUrl?e.geoNameUrl:y;n=n.replace("@{language}",t),r=r.replace("@{language}",t),this.config={language:t,types:(0,f.default)(t),provinces:(0,l.default)(t),maxResults:e.maxResults?e.maxResults:100,geoNameUrl:r,geoLocateUrl:n},this.config.types.filterValidTypes(e.includeTypes,e.excludeTypes)}return e.prototype.ui=function(e,t,n,r,i){return this.resultHandler=e?e.bind(this):this.defaultResultHandler,this.featureHandler=t?t.bind(this):this.defaultFeatureHandler,this.docFrag=document.createDocumentFragment(),n||(n=document.createElement("input"),this.docFrag.appendChild(n)),n.onkeyup=this.inputChanged.bind(this),i?this.featureContainer=i:(this.featureContainer=document.createElement("div"),this.docFrag.appendChild(this.featureContainer)),r?this.resultContainer=r:(this.resultContainer=document.createElement("div"),this.docFrag.appendChild(this.resultContainer)),this.resultContainer.classList.add("geosearch-ui"),this.featureContainer.classList.add("geosearch-ui"),this},e.prototype.defaultResultHandler=function(e){var t=document.createElement("ul");return e.reverse().forEach(function(e){var n=document.createElement("li");n.innerHTML=e.name+" ("+e.type+")"+(e.location?", "+e.location:"")+", "+e.province+" @ lat: "+e.LatLon.lat+", lon: "+e.LatLon.lon,t.appendChild(n)}),t},e.prototype.defaultFeatureHandler=function(e){var t;t=d.isFSAResult(e)?e.fsa+" - FSA located in "+e.province+" @ lat: "+e.LatLon.lat+", lon: "+e.LatLon.lon:e.nts+" - NTS located in "+e.location+" @ lat: "+e.LatLon.lat+", lon: "+e.LatLon.lon;var n=document.createElement("p");return n.innerHTML=t,n},e.prototype.inputChanged=function(e){var t=this,n=e.target.value;if(n.length>2&&n!==o){for(o=n;this.resultContainer.firstChild;)this.resultContainer.removeChild(this.resultContainer.firstChild);for(;this.featureContainer.firstChild;)this.featureContainer.removeChild(this.featureContainer.firstChild);this.query(n).onComplete.then(function(e){e.featureResults&&t.featureContainer.appendChild(t.featureHandler(e.featureResults)),t.resultContainer.appendChild(t.resultHandler(e.results))}).catch(function(e){var n=document.createElement("p");n.innerHTML=e,t.resultContainer.appendChild(n)})}},Object.defineProperty(e.prototype,"htmlElem",{get:function(){return this.docFrag},enumerable:!0,configurable:!0}),e.prototype.query=function(e){return u.make(this.config,e)},e}();t.GeoSearch=v,t.Q=u,t.Provinces=l.default,t.Types=f.default,t.Defs=d,window&&(window.GeoSearch=v)},91:function(e,t,n){"use strict";function r(e,t){if(/^[ABCEGHJKLMNPRSTVXY]\d[A-Z]/.test(t))return new u(e,t);if(/^\d{2,3}[A-P]/.test(t))return t=t.substring(0,6).toUpperCase(),new a(e,t);if(/^[A-Za-z]/.test(t)){var n=new o(e,t);return n.onComplete=n.search().then(function(e){return n.results=e,n}),n}var r=new o(e,t);return r.onComplete=new Promise(function(e,t){return e(r)}),r}Object.defineProperty(t,"__esModule",{value:!0}),t.make=r;var i=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(){function e(e,t){this.suggestions=[],this.results=[],this.query=t,this.config=e}return e.prototype.getUrl=function(e,t,n,r,i){var o="",a=n||this.query;return o=e?this.config.geoLocateUrl+"?q="+a:r&&i?this.config.geoNameUrl+"?lat="+r+"&lon="+i+"&num="+this.config.maxResults:this.config.geoNameUrl+"?q="+a+"&num="+this.config.maxResults,t&&(4===t.length?o+="&bbox="+t.join(","):o+="&province="+t.join(",")),o},e.prototype.normalizeNameItems=function(e){var t=this;return e.filter(function(e){return t.config.types.validTypes[e.concise.code]}).map(function(e){return{name:e.name,location:e.location,province:t.config.provinces.list[e.province.code],type:t.config.types.allTypes[e.concise.code],LatLon:{lat:e.latitude,lon:e.longitude},bbox:e.bbox}})},e.prototype.search=function(e){var t=this;return this.jsonRequest(this.getUrl(!1,e)).then(function(e){return t.normalizeNameItems(e.items)})},e.prototype.nameByLatLon=function(e,t,n){var r=this;return this.jsonRequest(this.getUrl(!1,n,void 0,e,t)).then(function(e){return r.normalizeNameItems(e.items)})},e.prototype.locateByQuery=function(e){return this.jsonRequest(this.getUrl(!0,void 0,e))},e.prototype.jsonRequest=function(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="json",r.onload=function(){200===r.status?t("string"==typeof r.response?JSON.parse(r.response):r.response):n("Could not load results from remote service.")},r.send()})},e}();t.Query=o;var a=function(e){function t(t,n){var r=this;return n=parseInt(n[2])?n:"0"+n,r=e.call(this,t,n)||this,r.unitName=n,r.onComplete=new Promise(function(e,t){r.locateByQuery().then(function(n){if(n.length>0&&r.query){var i=r.locateToResult(n);r.unit=i.splice(i.findIndex(function(e){return e.nts===r.query}),1)[0],r.mapSheets=i,r.featureResults=r.unit,r.nameByLatLon(r.unit.LatLon.lat,r.unit.LatLon.lon).then(function(t){r.results=t,e(r)})}else t("Not found")})}),r}return i(t,e),t.prototype.locateToResult=function(e){var t=this;return e.map(function(e){var n=e.title.split(" ");return{nts:n.shift()||"",location:n.join(" "),code:"NTS",desc:t.config.types.allTypes.NTS,LatLon:{lat:e.geometry.coordinates[1],lon:e.geometry.coordinates[0]},bbox:e.bbox}})},t.prototype.equals=function(e){return this.unitName===e.unitName},t}(o);t.NTSQuery=a;var u=function(e){function t(t,n){var r=this;return n=n.substring(0,3).toUpperCase(),r=e.call(this,t,n)||this,r.onComplete=new Promise(function(e,t){r.formatLocationResult().then(function(n){n?(r.featureResults=n,r.nameByLatLon(n.LatLon.lat,n.LatLon.lon,Object.keys(n._provinces).map(function(e){return parseInt(e)})).then(function(t){r.results=t,e(r)})):t("FSA code given cannot be found.")})}),r}return i(t,e),t.prototype.formatLocationResult=function(){var e=this;return this.locateByQuery().then(function(t){if(1===t.length&&e.query){var n=e.config.provinces.fsaToProvinces(e.query);return{fsa:e.query,code:"FSA",desc:e.config.types.allTypes.FSA,province:Object.keys(n).map(function(e){return n[e]}).join(","),_provinces:n,LatLon:{lat:t[0].geometry.coordinates[1],lon:t[0].geometry.coordinates[0]}}}})},t}(o);t.FSAQuery=u},92:function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return s[e]=s[e]?s[e]:new f(e)};var i=n(93),o=r(i),a=n(94),u=r(a),s={},l=u,c=o,f=function(){function e(e){var t=this;this.list={},Object.keys(c[e]).forEach(function(n){t.list[n]=c[e][n]})}return e.prototype.fsaToProvinces=function(e){var t=this,n={},r=l[e.substring(0,1).toUpperCase()];return"number"==typeof r&&(r=[r]),r.forEach(function(e){n[e]=t.list[e]}),n},e}()},93:function(e,t){e.exports={en:{10:"Newfoundland and Labrador",11:"Prince Edward Island",12:"Nova Scotia",13:"New Brunswick",24:"Quebec",35:"Ontario",46:"Manitoba",47:"Saskatchewan",48:"Alberta",59:"British Columbia",60:"Yukon",61:"Northwest Territories",62:"Nunavut",72:"Undersea Feature",73:"International Waters"},fr:{10:"Terre-Neuve-et-Labrador",11:"Île-du-Prince-Édouard",12:"Nouvelle-Écosse",13:"Nouveau-Brunswick",24:"Québec",35:"Ontario",46:"Manitoba",47:"Saskatchewan",48:"Alberta",59:"Colombie-Britannique",60:"Yukon",61:"Territoires du Nord-Ouest",62:"Nunavut",72:"Entité sous-marine",73:"Eaux internationales"}}},94:function(e,t){e.exports={A:10,B:12,C:11,E:13,G:24,H:24,J:24,K:35,L:35,M:35,N:35,P:35,R:46,S:47,T:48,V:59,X:[62,61],Y:60}},95:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return o[e]=o[e]?o[e]:new u(e)};var r=n(96),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(r),o={},a=i,u=function(){function e(e){var t=this;this.allTypes={},this.validTypes={},this.filterComplete=!1,Object.keys(a[e]).forEach(function(n){t.allTypes[n]=a[e][n],t.validTypes[n]=a[e][n]})}return e.prototype.filterValidTypes=function(e,t){if(this.filterComplete)return this.validTypes;e="string"==typeof e?[e]:e,t="string"==typeof t?[t]:t;var n=e||t?e&&e.length>0||t&&t.length:void 0;if(n)for(var r=Object.keys(this.validTypes),i=e||t||[],o=r.slice().filter(function(e){return!n==(-1!==i.indexOf(e))}),a=0,u=o;a<u.length;a++){var s=u[a];delete this.validTypes[s]}return this.filterComplete=!0,this.validTypes},e}()},96:function(e,t){e.exports={en:{FSA:"Forward Sortation Area",NTS:"National Topographic System",PROV:"Province",TERR:"Territory",CITY:"City",TOWN:"Town",VILG:"Village",HAM:"Hamlet",UTM:"Upper Tier Municipality",LTM:"Lower Tier Municipality",STM:"Single Tier Municipality",MUN1:"Other Municipal-District Area-Major Agglom.",MUN2:"Other Municipal-District Area-Miscellaneous",UNP:"Unincorporated place",IR:"Indian Reserve",GEOG:"Geographical Area",PARK:"Conservation Area",MIL:"Military Area",RIV:"River",RIVF:"River Feature",FALL:"Falls",LAKE:"Lake",SPRG:"Spring",SEA:"Sea",SEAF:"Sea Feature",SEAU:"Undersea Feature",CHAN:"Channel",RAP:"Rapids",BAY:"Bay",CAPE:"Cape",BCH:"Beach",SHL:"Shoal",ISL:"Island",CLF:"Cliff",MTN:"Mountain",VALL:"Valley",PLN:"Plain",CAVE:"Cave",CRAT:"Crater",GLAC:"Glacier",FOR:"Forest",VEGL:"Low Vegetation",MISC:"Miscellaneous",RAIL:"Railway Feature",ROAD:"Road Feature",AIR:"Air Navigation Feature",MAR:"Marine Navigation Feature",HYDR:"Hydraulic Construction",RECR:"Recreational Site",RES:"Natural Resources Site",CAMP:"Miscellaneous Campsite",SITE:"Miscellaneous Site"},fr:{FSA:"Région De Tri D'Acheminement",NTS:"Système National De Référence Cartographique",PROV:"Province",TERR:"Territoire",CITY:"Ville",TOWN:"Ville",VILG:"Village",HAM:"Hameau",UTM:"Municipalité de palier supérieure",LTM:"Municipalité de palier inférieur",STM:"Municipalité de palier simple",MUN1:"Autre zone municip.-District-Agglom. majeure",MUN2:"Autre zone municipale-District-Divers",UNP:"Lieu non organisé",IR:"Réserve indienne",GEOG:"Zone géographique",PARK:"Zone de préservation",MIL:"Réserve militaire",RIV:"Cours d'eau",RIVF:"Entité fluviale",FALL:"Chute",LAKE:"Lac",SPRG:"Source",SEA:"Mer",SEAF:"Entité maritime",SEAU:"Entité sous-marine",CHAN:"Chenal",RAP:"Rapide",BAY:"Baie",CAPE:"Cap",BCH:"Plage",SHL:"Haut-fond",ISL:"Île",CLF:"Escarpement",MTN:"Montagne",VALL:"Vallée",PLN:"Plaine",CAVE:"Caverne",CRAT:"Cratère",GLAC:"Glacier",FOR:"Forêt",VEGL:"Végétation basse",MISC:"Divers",RAIL:"Entité ferroviaire",ROAD:"Entité routière",AIR:"Entité de navigation aérienne",MAR:"Entité de navigation maritime",HYDR:"Construction hydraulique",RECR:"Site récréationnel",RES:"Site de ressources naturelles",CAMP:"Camp-Divers",SITE:"Site-Divers"}}},97:function(e,t,n){"use strict";function r(e){return!!e.fsa}function i(e){return!!e.nts}Object.defineProperty(t,"__esModule",{value:!0}),t.isFSAResult=r,t.isNTSResult=i}});
//# sourceMappingURL=geosearch.js.map